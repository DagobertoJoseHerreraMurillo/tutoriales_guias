---
title: "Datos Salud"
author: "ronny hdez-mora & Erick Calderón Morales"
date: "`r format(Sys.time(), '%d %B, %Y')`"
always_allow_html: yes
output:
  html_document:
    code_folding: hide
    number_sections: no
    theme: spacelab
    toc: yes
    toc_float:
      collapsed: no
editor_options:
  chunk_output_type: console
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(readr)
library(junr)
library(dplyr)
library(ggplot2)
```

# Comunicación con el API
En primer lugar para traer los datos que el Gobierno de Costa Rica tiene 
disponibles y abiertos, tenemos que seguir una serie de pasos en nuestra sesión.
La que presentamos acá no es la única manera de hacerlo,  pero tratamos de 
presentar un paso a paso que nos lleve a identificar fácilmente los conjuntos
de datos existentes y cómo tener un vistazo rápido de las dimensiones.


## Credenciales
Uno de los primeros paso es que debemos de crear como objetos las credenciales
para poder comunicarnos con el API de datos abiertos del Gobierno de CR.
```{r, cache = TRUE, echo = FALSE, message = FALSE}
url_base <- "http://api.datosabiertos.presidencia.go.cr/api/v2/datastreams/"
api_key <- "a5fff4275119df5926a807941576f6cad95cf84f"

```

## Revisar cuales conjuntos de datos existen
```{r, cache = TRUE, echo = FALSE, message = FALSE}
indice <- get_index(url_base, api_key = api_key)
guid <- indice %>% 
  select(title, guid)
dimensiones <- get_dimensions(base_url = url_base, api_key = api_key)
dimensiones <- left_join(dimensiones, guid, by = c("GUID" = "guid"))
dim_ordenado <- dimensiones %>%
    arrange(desc(DIM))
```

### Traer conjunto de datos de salud
Una vez identificado el conjunto de datos podemos anotar el GUID y con este
hacer el llamado específico. En nuestro caso estamos interesados en el conjunto
de datos **Base de datos RNT** y cuyo GUID es **BASE-DE-DATOS-RNT**
```{r, cache = TRUE, echo = FALSE, message = FALSE}
# Anotar en un objeto el GUID de la tabla que nos interesa
guid_tabla <- "BASE-DE-DATOS-RNT"

# Llamar la tabla. Usamos las mismas credenciales que habíamos usado
asist_educacion <- get_data(base_url = url_base, api_key = api_key, 
                            guid = guid_tabla)
```

